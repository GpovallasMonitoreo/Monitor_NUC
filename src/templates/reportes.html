<!DOCTYPE html>
<html class="light" lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Argos DOOH - Generar Reportes</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f97415",
                        "primary-dark": "#c2570e",
                        "background-light": "#f8f7f5",
                        "background-dark": "#23170f",
                        "surface-light": "#ffffff",
                        "surface-dark": "#2d2420",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "body": ["Inter", "sans-serif"],
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .report-card {
            transition: all 0.3s ease;
        }
        .report-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 antialiased">
    <!-- Header -->
    <header class="flex h-16 items-center justify-between border-b border-slate-200 dark:border-slate-800 bg-surface-light dark:bg-surface-dark px-8">
        <div class="flex items-center gap-2">
            <div class="flex items-center justify-center size-8 rounded-lg bg-primary text-white">
                <span class="material-symbols-outlined">ad_units</span>
            </div>
            <div class="flex flex-col">
                <h1 class="text-slate-900 dark:text-white text-base font-bold">Argos DOOH</h1>
                <p class="text-slate-500 dark:text-slate-400 text-xs">Generar Reportes</p>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <a href="/" class="px-4 py-2 text-sm font-medium text-primary hover:bg-primary/10 rounded-lg transition">
                ← Volver al Dashboard
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-8">
        <div class="max-w-[1400px] mx-auto">
            <!-- Header Section -->
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Generar Reportes</h2>
                <p class="text-slate-500 dark:text-slate-400 mt-2">Crea y descarga reportes detallados del sistema</p>
            </div>

            <!-- Quick Reports -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Quick Report 1 -->
                <div class="report-card bg-white dark:bg-surface-dark rounded-xl p-6 border border-slate-200 dark:border-slate-800">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-emerald-100 dark:bg-emerald-500/20 rounded-lg">
                            <span class="material-symbols-outlined text-emerald-600 dark:text-emerald-400">trending_up</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-900 dark:text-white">Reporte Diario</h4>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Resumen del día</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Informe rápido del estado actual del sistema.</p>
                    <button onclick="generateDailyReport()" class="w-full px-4 py-2 bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-400 font-medium rounded-lg hover:bg-emerald-200 dark:hover:bg-emerald-500/30 transition">
                        Generar Ahora
                    </button>
                </div>

                <!-- Quick Report 2 -->
                <div class="report-card bg-white dark:bg-surface-dark rounded-xl p-6 border border-slate-200 dark:border-slate-800">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-blue-100 dark:bg-blue-500/20 rounded-lg">
                            <span class="material-symbols-outlined text-blue-600 dark:text-blue-400">calendar_month</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-900 dark:text-white">Reporte Mensual</h4>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Análisis completo</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Análisis detallado del mes en curso.</p>
                    <button onclick="generateMonthlyReport()" class="w-full px-4 py-2 bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-400 font-medium rounded-lg hover:bg-blue-200 dark:hover:bg-blue-500/30 transition">
                        Generar Ahora
                    </button>
                </div>

                <!-- Quick Report 3 -->
                <div class="report-card bg-white dark:bg-surface-dark rounded-xl p-6 border border-slate-200 dark:border-slate-800">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-purple-100 dark:bg-purple-500/20 rounded-lg">
                            <span class="material-symbols-outlined text-purple-600 dark:text-purple-400">summarize</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-900 dark:text-white">Reporte Trimestral</h4>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Evaluación trimestral</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Evaluación de desempeño del trimestre.</p>
                    <button onclick="generateQuarterlyReport()" class="w-full px-4 py-2 bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-400 font-medium rounded-lg hover:bg-purple-200 dark:hover:bg-purple-500/30 transition">
                        Generar Ahora
                    </button>
                </div>

                <!-- Quick Report 4 -->
                <div class="report-card bg-white dark:bg-surface-dark rounded-xl p-6 border border-slate-200 dark:border-slate-800">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="p-3 bg-red-100 dark:bg-red-500/20 rounded-lg">
                            <span class="material-symbols-outlined text-red-600 dark:text-red-400">warning</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-900 dark:text-white">Reporte de Alertas</h4>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Incidencias críticas</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Reporte de alertas y problemas críticos.</p>
                    <button onclick="generateAlertsReport()" class="w-full px-4 py-2 bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-400 font-medium rounded-lg hover:bg-red-200 dark:hover:bg-red-500/30 transition">
                        Generar Ahora
                    </button>
                </div>
            </div>

            <!-- Custom Report Generator -->
            <div class="bg-white dark:bg-surface-dark rounded-xl shadow-sm border border-slate-200/60 dark:border-slate-800 p-6 mb-8">
                <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-6">Generar Reporte Personalizado</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <!-- Report Type -->
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Tipo de Reporte</label>
                        <select id="report-type" class="w-full px-4 py-2 border border-slate-200 dark:border-slate-800 rounded-lg bg-white dark:bg-[#2a1d15]">
                            <option value="rentabilidad">Rentabilidad</option>
                            <option value="incidencias">Incidencias</option>
                            <option value="mantenimientos">Mantenimientos</option>
                            <option value="refacciones">Refacciones</option>
                            <option value="financiero">Financiero Completo</option>
                            <option value="operativo">Operativo</option>
                        </select>
                    </div>

                    <!-- Time Period -->
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Período</label>
                        <select id="report-period" class="w-full px-4 py-2 border border-slate-200 dark:border-slate-800 rounded-lg bg-white dark:bg-[#2a1d15]">
                            <option value="daily">Diario</option>
                            <option value="weekly">Semanal</option>
                            <option value="monthly">Mensual</option>
                            <option value="quarterly">Trimestral</option>
                            <option value="yearly">Anual</option>
                            <option value="custom">Personalizado</option>
                        </select>
                    </div>
                </div>

                <!-- Custom Date Range (hidden by default) -->
                <div id="custom-date-range" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6 hidden">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Fecha Inicio</label>
                        <input type="date" id="start-date" class="w-full px-4 py-2 border border-slate-200 dark:border-slate-800 rounded-lg bg-white dark:bg-[#2a1d15]">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Fecha Fin</label>
                        <input type="date" id="end-date" class="w-full px-4 py-2 border border-slate-200 dark:border-slate-800 rounded-lg bg-white dark:bg-[#2a1d15]">
                    </div>
                </div>

                <!-- Screens Selection -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Pantallas a Incluir</label>
                    <div class="flex gap-4">
                        <label class="flex items-center">
                            <input type="radio" name="screens-selection" value="all" class="mr-2" checked>
                            <span class="text-sm">Todas las Pantallas</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="screens-selection" value="selected" class="mr-2">
                            <span class="text-sm">Seleccionar Pantallas</span>
                        </label>
                    </div>
                </div>

                <!-- Format Selection -->
                <div class="mb-8">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Formato de Salida</label>
                    <div class="flex gap-4">
                        <label class="flex items-center">
                            <input type="radio" name="output-format" value="csv" class="mr-2" checked>
                            <span class="text-sm">CSV (Excel)</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="output-format" value="pdf" class="mr-2">
                            <span class="text-sm">PDF</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="output-format" value="excel" class="mr-2">
                            <span class="text-sm">Excel (.xlsx)</span>
                        </label>
                    </div>
                </div>

                <!-- Generate Button -->
                <button onclick="generateCustomReport()" class="w-full px-6 py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary-dark transition flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">summarize</span>
                    Generar Reporte Personalizado
                </button>
            </div>

            <!-- Recent Reports -->
            <div class="bg-white dark:bg-surface-dark rounded-xl shadow-sm border border-slate-200/60 dark:border-slate-800 p-6">
                <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-6">Reportes Recientes</h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-slate-200 dark:border-slate-800">
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Nombre del Reporte</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Tipo</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Período</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Fecha</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Tamaño</th>
                                <th class="py-3 px-4 text-left text-sm font-semibold text-slate-700 dark:text-slate-300">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="recent-reports">
                            <!-- Los reportes se cargarán aquí -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Datos de ejemplo para reportes
        const recentReports = [
            {
                id: 1,
                name: 'Reporte Mensual de Rentabilidad',
                type: 'Rentabilidad',
                period: 'Febrero 2024',
                date: '2024-02-28',
                size: '2.4 MB',
                format: 'PDF'
            },
            {
                id: 2,
                name: 'Reporte de Mantenimientos',
                type: 'Mantenimientos',
                period: 'Último Trimestre',
                date: '2024-02-25',
                size: '1.8 MB',
                format: 'CSV'
            },
            {
                id: 3,
                name: 'Reporte de Incidencias',
                type: 'Incidencias',
                period: 'Última Semana',
                date: '2024-02-27',
                size: '1.2 MB',
                format: 'Excel'
            },
            {
                id: 4,
                name: 'Reporte Financiero Anual',
                type: 'Financiero',
                period: 'Año 2023',
                date: '2024-01-15',
                size: '4.5 MB',
                format: 'PDF'
            }
        ];

        // Mostrar/Ocultar rango de fechas personalizado
        document.getElementById('report-period').addEventListener('change', function() {
            const customRangeDiv = document.getElementById('custom-date-range');
            if (this.value === 'custom') {
                customRangeDiv.classList.remove('hidden');
            } else {
                customRangeDiv.classList.add('hidden');
            }
        });

        // Cargar reportes recientes
        function loadRecentReports() {
            const tbody = document.getElementById('recent-reports');
            
            if (recentReports.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="py-8 text-center text-slate-400 dark:text-slate-500">
                            <div class="flex flex-col items-center gap-2">
                                <span class="material-symbols-outlined">description</span>
                                <p>No hay reportes recientes</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = recentReports.map(report => `
                <tr class="border-b border-slate-200 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800/50">
                    <td class="py-4 px-4">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-primary/10 rounded-lg">
                                <span class="material-symbols-outlined text-primary">description</span>
                            </div>
                            <div>
                                <p class="font-medium text-slate-900 dark:text-white">${report.name}</p>
                                <p class="text-xs text-slate-500">Formato: ${report.format}</p>
                            </div>
                        </div>
                    </td>
                    <td class="py-4 px-4">
                        <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium ${getReportTypeColor(report.type)}">
                            ${report.type}
                        </span>
                    </td>
                    <td class="py-4 px-4 text-sm">${report.period}</td>
                    <td class="py-4 px-4 text-sm">${report.date}</td>
                    <td class="py-4 px-4 text-sm">${report.size}</td>
                    <td class="py-4 px-4">
                        <div class="flex items-center gap-2">
                            <button onclick="downloadReport(${report.id})" class="p-1.5 text-primary hover:bg-primary/10 rounded">
                                <span class="material-symbols-outlined text-sm">download</span>
                            </button>
                            <button onclick="deleteReport(${report.id})" class="p-1.5 text-red-500 hover:bg-red-100 dark:hover:bg-red-500/10 rounded">
                                <span class="material-symbols-outlined text-sm">delete</span>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function getReportTypeColor(type) {
            const colors = {
                'Rentabilidad': 'bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-400',
                'Mantenimientos': 'bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-400',
                'Incidencias': 'bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-400',
                'Financiero': 'bg-blue-100 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400',
                'Operativo': 'bg-purple-100 text-purple-700 dark:bg-purple-500/20 dark:text-purple-400',
                'Refacciones': 'bg-cyan-100 text-cyan-700 dark:bg-cyan-500/20 dark:text-cyan-400'
            };
            return colors[type] || 'bg-slate-100 text-slate-700 dark:bg-slate-500/20 dark:text-slate-400';
        }

        // Funciones de generación de reportes
        function generateDailyReport() {
            showNotification('Generando reporte diario...', 'info');
            setTimeout(() => {
                generateCSV('reporte-diario', [
                    ['REPORTE DIARIO', `Fecha: ${new Date().toISOString().split('T')[0]}`],
                    [''],
                    ['RESUMEN DEL DÍA'],
                    ['Pantallas Totales', '10'],
                    ['Pantallas En Línea', '8'],
                    ['Pantallas en Mantenimiento', '1'],
                    ['Pantallas Desconectadas', '1'],
                    ['Incidencias Reportadas', '3'],
                    ['Mantenimientos Realizados', '2'],
                    [''],
                    ['ALERTAS ACTIVAS'],
                    ['Pantalla', 'Tipo', 'Hora', 'Estado'],
                    ['ARG-004', 'Desconectada', '08:30', 'Pendiente'],
                    ['ARG-007', 'Mantenimiento', '10:15', 'En Proceso']
                ]);
                showNotification('Reporte diario generado exitosamente', 'success');
            }, 1000);
        }

        function generateMonthlyReport() {
            showNotification('Generando reporte mensual...', 'info');
            setTimeout(() => {
                generateCSV('reporte-mensual', [
                    ['REPORTE MENSUAL', `Período: Febrero 2024`],
                    [''],
                    ['RESUMEN FINANCIERO'],
                    ['Ingresos Totales', '$85,400'],
                    ['Gastos Totales', '$32,150'],
                    ['Ganancia Neta', '$53,250'],
                    ['ROI Promedio', '18.2 meses'],
                    [''],
                    ['ESTADÍSTICAS OPERATIVAS'],
                    ['Uptime Promedio', '98.7%'],
                    ['Mantenimientos Realizados', '15'],
                    ['Incidencias Reportadas', '8'],
                    ['Tiempo Medio de Respuesta', '2.3 horas'],
                    [''],
                    ['DESEMPEÑO POR PANTALLA'],
                    ['Pantalla', 'Ingresos', 'Gastos', 'ROI', 'Uptime'],
                    ['ARG-001', '$8,500', '$3,200', '14.5', '99.8%'],
                    ['ARG-002', '$12,000', '$4,500', '18.2', '99.5%'],
                    ['ARG-005', '$10,500', '$3,800', '12.3', '99.9%']
                ]);
                showNotification('Reporte mensual generado exitosamente', 'success');
            }, 1500);
        }

        function generateQuarterlyReport() {
            showNotification('Generando reporte trimestral...', 'info');
            setTimeout(() => {
                generateCSV('reporte-trimestral', [
                    ['REPORTE TRIMESTRAL', `Período: Q1 2024`],
                    [''],
                    ['ANÁLISIS FINANCIERO'],
                    ['Ingresos Trimestrales', '$256,200'],
                    ['Gastos Operativos', '$96,450'],
                    ['Ganancia Neta', '$159,750'],
                    ['Margen de Ganancia', '62.4%'],
                    ['ROI Promedio', '16.8 meses'],
                    [''],
                    ['TENDENCIAS'],
                    ['Crecimiento Mensual', '+12%'],
                    ['Reducción de Costos', '-8%'],
                    ['Mejora en ROI', '+15%'],
                    ['Aumento Uptime', '+2.3%'],
                    [''],
                    ['RECOMENDACIONES'],
                    ['1. Expandir a 2 nuevas ubicaciones'],
                    ['2. Optimizar mantenimientos preventivos'],
                    ['3. Implementar monitoreo predictivo'],
                    ['4. Renovar equipos con ROI > 24 meses']
                ]);
                showNotification('Reporte trimestral generado exitosamente', 'success');
            }, 2000);
        }

        function generateAlertsReport() {
            showNotification('Generando reporte de alertas...', 'info');
            setTimeout(() => {
                generateCSV('reporte-alertas', [
                    ['REPORTE DE ALERTAS', `Período: Últimos 30 días`],
                    [''],
                    ['RESUMEN DE ALERTAS'],
                    ['Alertas Totales', '24'],
                    ['Alertas Críticas', '8'],
                    ['Alertas Medias', '10'],
                    ['Alertas Bajas', '6'],
                    ['Tiempo Medio de Resolución', '3.2 horas'],
                    [''],
                    ['ALERTAS CRÍTICAS DETALLADAS'],
                    ['Fecha', 'Pantalla', 'Tipo', 'Duración', 'Causa', 'Acción'],
                    ['2024-02-28', 'ARG-004', 'Desconexión', '4.5h', 'Falla eléctrica', 'Revisión técnica'],
                    ['2024-02-25', 'ARG-007', 'Sobrecalentamiento', '2.0h', 'Ventilador dañado', 'Reemplazo'],
                    ['2024-02-20', 'ARG-003', 'Problema visual', '3.0h', 'Módulo LED dañado', 'Reemplazo'],
                    ['2024-02-18', 'ARG-001', 'Sin conexión', '1.5h', 'Problema de red', 'Reinicio de router']
                ]);
                showNotification('Reporte de alertas generado exitosamente', 'success');
            }, 1000);
        }

        function generateCustomReport() {
            const reportType = document.getElementById('report-type').value;
            const period = document.getElementById('report-period').value;
            const format = document.querySelector('input[name="output-format"]:checked').value;

            let periodText = '';
            switch(period) {
                case 'daily': periodText = 'Diario'; break;
                case 'weekly': periodText = 'Semanal'; break;
                case 'monthly': periodText = 'Mensual'; break;
                case 'quarterly': periodText = 'Trimestral'; break;
                case 'yearly': periodText = 'Anual'; break;
                case 'custom': periodText = 'Personalizado'; break;
            }

            showNotification(`Generando reporte ${reportType} ${periodText.toLowerCase()}...`, 'info');
            
            setTimeout(() => {
                const date = new Date().toISOString().split('T')[0];
                const filename = `reporte-${reportType}-${period}-${date}`;
                
                // Generar datos según el tipo de reporte
                const data = generateCustomReportData(reportType, period);
                
                if (format === 'csv') {
                    generateCSV(filename, data);
                } else {
                    // Para PDF o Excel, simular descarga
                    alert(`Reporte ${filename} generado en formato ${format.toUpperCase()}`);
                }
                
                showNotification('Reporte personalizado generado exitosamente', 'success');
                
                // Agregar a reportes recientes
                addToRecentReports({
                    name: `Reporte de ${reportType}`,
                    type: formatReportType(reportType),
                    period: periodText,
                    date: date,
                    size: '1.5 MB',
                    format: format.toUpperCase()
                });
            }, 2000);
        }

        function generateCustomReportData(type, period) {
            const date = new Date();
            let headers, rows;

            switch(type) {
                case 'rentabilidad':
                    headers = ['Pantalla', 'Ingresos', 'Gastos', 'Ganancia', 'ROI', 'Margen %'];
                    rows = [
                        ['ARG-001', '8500', '3200', '5300', '14.5', '62.4%'],
                        ['ARG-002', '12000', '4500', '7500', '18.2', '62.5%'],
                        ['ARG-005', '10500', '3800', '6700', '12.3', '63.8%'],
                        ['ARG-008', '9200', '3500', '5700', '15.2', '62.0%']
                    ];
                    break;
                
                case 'incidencias':
                    headers = ['Fecha', 'Pantalla', 'Tipo', 'Severidad', 'Duración (h)', 'Estado'];
                    rows = [
                        ['2024-02-28', 'ARG-004', 'Desconexión', 'Alta', '4.5', 'Resuelta'],
                        ['2024-02-25', 'ARG-007', 'Sobrecalentamiento', 'Media', '2.0', 'Resuelta'],
                        ['2024-02-20', 'ARG-003', 'Visual', 'Alta', '3.0', 'Resuelta'],
                        ['2024-02-18', 'ARG-001', 'Red', 'Baja', '1.5', 'Resuelta']
                    ];
                    break;
                
                case 'mantenimientos':
                    headers = ['Fecha', 'Pantalla', 'Tipo', 'Horas', 'Costo', 'Técnico', 'Estado'];
                    rows = [
                        ['2024-02-20', 'ARG-007', 'Preventivo', '4.0', '$600', 'Juan Pérez', 'Completado'],
                        ['2024-02-18', 'ARG-003', 'Correctivo', '3.5', '$850', 'María López', 'Completado'],
                        ['2024-02-15', 'ARG-001', 'Preventivo', '3.0', '$450', 'Carlos Ruiz', 'Completado'],
                        ['2024-02-10', 'ARG-002', 'Correctivo', '2.5', '$750', 'Ana García', 'Completado']
                    ];
                    break;
                
                case 'refacciones':
                    headers = ['Refacción', 'Número de Serie', 'Costo', 'Stock', 'Último Uso', 'Vida Restante'];
                    rows = [
                        ['Módulo LED', 'LED-2024-001', '$250', '12', '2024-02-15', '24 meses'],
                        ['Fuente de Poder', 'PWR-2024-002', '$180', '3', '2024-02-18', '18 meses'],
                        ['Novastar MCTRL300', 'NOVA-2024-003', '$350', '5', '2024-02-10', '36 meses'],
                        ['Cable FAT', 'CBL-2024-004', '$45', '20', '2024-02-05', '12 meses']
                    ];
                    break;
                
                case 'financiero':
                    headers = ['Concepto', 'Enero', 'Febrero', 'Marzo', 'Total'];
                    rows = [
                        ['Ingresos', '65000', '85400', '92000', '242400'],
                        ['Gastos', '28000', '32150', '38000', '98150'],
                        ['Ganancia', '37000', '53250', '54000', '144250'],
                        ['ROI Promedio', '16.5', '18.2', '17.8', '17.5']
                    ];
                    break;
                
                default:
                    headers = ['Columna 1', 'Columna 2', 'Columna 3'];
                    rows = [['Dato 1', 'Dato 2', 'Dato 3']];
            }

            const title = `REPORTE DE ${formatReportType(type).toUpperCase()} - ${period.toUpperCase()}`;
            const subtitle = `Fecha de generación: ${new Date().toISOString().split('T')[0]}`;
            
            return [[title], [subtitle], [''], headers, ...rows];
        }

        function formatReportType(type) {
            const types = {
                'rentabilidad': 'Rentabilidad',
                'incidencias': 'Incidencias',
                'mantenimientos': 'Mantenimientos',
                'refacciones': 'Refacciones',
                'financiero': 'Financiero',
                'operativo': 'Operativo'
            };
            return types[type] || type;
        }

        function generateCSV(filename, data) {
            const csvContent = data.map(row => 
                row.map(cell => `"${cell}"`).join(',')
            ).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `${filename}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function downloadReport(reportId) {
            const report = recentReports.find(r => r.id === reportId);
            if (report) {
                showNotification(`Descargando ${report.name}...`, 'info');
                setTimeout(() => {
                    showNotification(`${report.name} descargado exitosamente`, 'success');
                }, 1000);
            }
        }

        function deleteReport(reportId) {
            if (confirm('¿Estás seguro de eliminar este reporte?')) {
                showNotification('Reporte eliminado', 'info');
            }
        }

        function addToRecentReports(report) {
            recentReports.unshift({
                id: recentReports.length + 1,
                ...report
            });
            loadRecentReports();
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const typeClasses = {
                'success': 'bg-emerald-500 text-white',
                'error': 'bg-red-500 text-white',
                'info': 'bg-blue-500 text-white'
            };

            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${typeClasses[type]} animate-fade-in`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined">
                        ${type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'info'}
                    </span>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Añadir estilo para animación
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fade-in {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fade-in 0.3s ease-out;
            }
        `;
        document.head.appendChild(style);

        // Cargar reportes al iniciar
        document.addEventListener('DOMContentLoaded', loadRecentReports);
    </script>
</body>
</html>
